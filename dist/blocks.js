(()=>{var e={251:(e,t,o)=>{"use strict";var l=o(196),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,i=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,o){var l,r={},c=null,d=null;for(l in void 0!==o&&(c=""+o),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,l)&&!s.hasOwnProperty(l)&&(r[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps)void 0===r[l]&&(r[l]=t[l]);return{$$typeof:n,type:e,key:c,ref:d,props:r,_owner:i.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},893:(e,t,o)=>{"use strict";e.exports=o(251)},196:e=>{"use strict";e.exports=window.React},967:(e,t)=>{var o;!function(){"use strict";var l={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var o=arguments[t];o&&(e=a(e,r(o)))}return e}function r(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var o in e)l.call(e,o)&&e[o]&&(t=a(t,o));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(o=function(){return n}.apply(t,[]))||(e.exports=o)}()}},t={};function o(l){var n=t[l];if(void 0!==n)return n.exports;var r=t[l]={exports:{}};return e[l](r,r.exports,o),r.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var l in t)o.o(t,l)&&!o.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e={};o.r(e),o.d(e,{name:()=>z,settings:()=>E});var t={};o.r(t),o.d(t,{name:()=>R,settings:()=>P});var l={};o.r(l),o.d(l,{name:()=>D,settings:()=>A});var n={};o.r(n),o.d(n,{name:()=>G,settings:()=>L});var r={};o.r(r),o.d(r,{name:()=>$,settings:()=>W});const a=window.wp.blocks;var i=o(893);const s=window.wp.i18n,c=window.wp.blockEditor;var d=o(196);const u=window.wp.primitives,v=(0,d.createElement)(u.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,d.createElement)(u.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v3.5h-15V5c0-.3.2-.5.5-.5zm8 5.5h6.5v3.5H13V10zm-1.5 3.5h-7V10h7v3.5zm-7 5.5v-4h7v4.5H5c-.3 0-.5-.2-.5-.5zm14.5.5h-6V15h6.5v4c0 .3-.2.5-.5.5z"})),p=window.wp.element,m=window.wp.components,b=window.wp.data;var h=o(967),w=o.n(h);function k(e){const{setAttributes:t,clientId:o}=e,[l,n]=(0,p.useState)(2),[r,a]=(0,p.useState)(2);return(0,i.jsx)(m.Placeholder,{label:(0,s.__)("Table","tp"),icon:(0,i.jsx)(c.BlockIcon,{icon:v,showColors:!0}),instructions:(0,s.__)("Insert a table for sharing data.","tp"),children:(0,i.jsxs)("form",{className:"travelopia-table__placeholder-form",onSubmit:e=>{e.preventDefault(),t({rows:l,columns:r}),F("tbody",o)},children:[(0,i.jsx)(m.TextControl,{type:"number",label:(0,s.__)("Column count","tp"),value:r,onChange:e=>a(parseInt(e)),min:"1",className:"travelopia-table__placeholder-input"}),(0,i.jsx)(m.TextControl,{type:"number",label:(0,s.__)("Row count","tp"),value:l,onChange:e=>n(parseInt(e)),min:"1",className:"travelopia-table__placeholder-input"}),(0,i.jsx)(m.Button,{variant:"primary",type:"submit",children:(0,s.__)("Create Table","tp")})]})})}const g=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,d.createElement)(u.Path,{d:"M6.656 6.464h2.88v2.88h1.408v-2.88h2.88V5.12h-2.88V2.24H9.536v2.88h-2.88zM0 17.92V0h20.48v17.92H0zm7.68-2.56h5.12v-3.84H7.68v3.84zm-6.4 0H6.4v-3.84H1.28v3.84zM19.2 1.28H1.28v9.024H19.2V1.28zm0 10.24h-5.12v3.84h5.12v-3.84zM6.656 6.464h2.88v2.88h1.408v-2.88h2.88V5.12h-2.88V2.24H9.536v2.88h-2.88zM0 17.92V0h20.48v17.92H0zm7.68-2.56h5.12v-3.84H7.68v3.84zm-6.4 0H6.4v-3.84H1.28v3.84zM19.2 1.28H1.28v9.024H19.2V1.28zm0 10.24h-5.12v3.84h5.12v-3.84z"})),f=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,d.createElement)(u.Path,{d:"M13.824 10.176h-2.88v-2.88H9.536v2.88h-2.88v1.344h2.88v2.88h1.408v-2.88h2.88zM0 17.92V0h20.48v17.92H0zM6.4 1.28H1.28v3.84H6.4V1.28zm6.4 0H7.68v3.84h5.12V1.28zm6.4 0h-5.12v3.84h5.12V1.28zm0 5.056H1.28v9.024H19.2V6.336z"})),_=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,d.createElement)(u.Path,{d:"M17.728 11.456L14.592 8.32l3.2-3.2-1.536-1.536-3.2 3.2L9.92 3.648 8.384 5.12l3.2 3.2-3.264 3.264 1.536 1.536 3.264-3.264 3.136 3.136 1.472-1.536zM0 17.92V0h20.48v17.92H0zm19.2-6.4h-.448l-1.28-1.28H19.2V6.4h-1.792l1.28-1.28h.512V1.28H1.28v3.84h6.208l1.28 1.28H1.28v3.84h7.424l-1.28 1.28H1.28v3.84H19.2v-3.84z"})),y=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,d.createElement)(u.Path,{d:"M6.4 3.776v3.648H2.752v1.792H6.4v3.648h1.728V9.216h3.712V7.424H8.128V3.776zM0 17.92V0h20.48v17.92H0zM12.8 1.28H1.28v14.08H12.8V1.28zm6.4 0h-5.12v3.84h5.12V1.28zm0 5.12h-5.12v3.84h5.12V6.4zm0 5.12h-5.12v3.84h5.12v-3.84z"})),x=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,d.createElement)(u.Path,{d:"M14.08 12.864V9.216h3.648V7.424H14.08V3.776h-1.728v3.648H8.64v1.792h3.712v3.648zM0 17.92V0h20.48v17.92H0zM6.4 1.28H1.28v3.84H6.4V1.28zm0 5.12H1.28v3.84H6.4V6.4zm0 5.12H1.28v3.84H6.4v-3.84zM19.2 1.28H7.68v14.08H19.2V1.28z"})),B=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,d.createElement)(u.Path,{d:"M6.4 9.98L7.68 8.7v-.256L6.4 7.164V9.98zm6.4-1.532l1.28-1.28V9.92L12.8 8.64v-.192zm7.68 9.472V0H0v17.92h20.48zm-1.28-2.56h-5.12v-1.024l-.256.256-1.024-1.024v1.792H7.68v-1.792l-1.024 1.024-.256-.256v1.024H1.28V1.28H6.4v2.368l.704-.704.576.576V1.216h5.12V3.52l.96-.96.32.32V1.216h5.12V15.36zm-5.76-2.112l-3.136-3.136-3.264 3.264-1.536-1.536 3.264-3.264L5.632 5.44l1.536-1.536 3.136 3.136 3.2-3.2 1.536 1.536-3.2 3.2 3.136 3.136-1.536 1.536z"})),I=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,d.createElement)(u.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"})),C=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,d.createElement)(u.Path,{d:"m14.5 6.5-1 1 3.7 3.7H4v1.6h13.2l-3.7 3.7 1 1 5.6-5.5z"})),j=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,d.createElement)(u.Path,{d:"M12 3.9 6.5 9.5l1 1 3.8-3.7V20h1.5V6.8l3.7 3.7 1-1z"})),V=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,d.createElement)(u.Path,{d:"m16.5 13.5-3.7 3.7V4h-1.5v13.2l-3.8-3.7-1 1 5.5 5.6 5.5-5.6z"})),S=(0,d.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,d.createElement)(u.Path,{d:"M4 6v11.5h16V6H4zm1.5 1.5h6V11h-6V7.5zm0 8.5v-3.5h6V16h-6zm13 0H13v-3.5h5.5V16zM13 11V7.5h5.5V11H13z"}));const H=function(e){const{attributes:t,setAttributes:o}=e,l=(0,c.useBlockProps)({className:"travelopia-table__cell"});return(0,i.jsx)(c.RichText,Object.assign({tagName:"span"},l,{placeholder:(0,s.__)("Cell content","tp"),onChange:e=>o({content:e}),value:t.content}))},z="travelopia/table-cell",E={apiVersion:3,icon:v,title:(0,s.__)("Cell","tp"),description:(0,s.__)("Individual cell of the table.","tp"),parent:["travelopia/table-column"],category:"text",keywords:[(0,s.__)("cell","tp")],attributes:{content:{type:"string",source:"html"}},supports:{html:!0,className:!1},transforms:{to:[{type:"block",blocks:["core/heading"],transform:(e,t)=>(0,a.createBlock)("core/heading",Object.assign(Object.assign({},e),{level:"3"}),t)},{type:"block",blocks:["core/paragraph"],transform:(e,t)=>(0,a.createBlock)("core/paragraph",e,t)},{type:"block",blocks:["core/list"],transform:(e,t)=>(0,a.createBlock)("core/list",{},[(0,a.createBlock)("core/list-item",e,t)])}]},edit:H,save:({attributes:e})=>(0,i.jsx)(c.RichText.Content,{value:e.content})};function T({isSelected:e,tableId:t,tableRow:o,tableColumn:l,rowContainerId:n,realTableRow:r,realTableColumn:d}){var u,v,h,w,k,H,E,T,O,P;const{getBlock:M,canInsertBlockType:A,getBlockAttributes:N,canRemoveBlock:L}=(0,b.select)("core/block-editor"),{removeBlock:F,removeBlocks:U,insertBlock:Y,updateBlockAttributes:$,moveBlocksToPosition:W}=(0,b.dispatch)("core/block-editor"),[q,J]=(0,p.useState)(0),K=(0,p.useMemo)((()=>M(n)),[n,M]);(0,p.useEffect)((()=>{const e=M(t);e?e.innerBlocks.some(((e,t)=>!(e.name!==D||t+1!==o||!e.innerBlocks.length)&&(J(e.innerBlocks.length),!0))):J(0)}),[o,l,M,t]);const Q=(e=0)=>{var l,r;const i=M(t);if(!i)return;if(!A(D,n))return;const s=[];for(let e=0;e<(null===(l=i.attributes)||void 0===l?void 0:l.columns);e++)s.push((0,a.createBlock)(R,{},[(0,a.createBlock)(z)]));const c=(0,a.createBlock)(D,{},s);Y(c,o+e,n),$(t,{rows:(null===(r=i.attributes)||void 0===r?void 0:r.rows)+1})},X=(e=0)=>{var o;const n=M(t);n&&K&&(n.innerBlocks.forEach((t=>{t.name===G&&t.innerBlocks.forEach((t=>{if(t.name!==D)return;if(!A(R,t.clientId))return;const o=(0,a.createBlock)(R,{},[(0,a.createBlock)(z)]);Y(o,l+e,t.clientId)}))})),$(t,{columns:(null===(o=n.attributes)||void 0===o?void 0:o.columns)+1}))},Z=(e,t)=>{var o,l,n,r;const a=N(t.clientId),i=N(e.clientId);if(parseInt(null!==(o=null==a?void 0:a.rowSpan)&&void 0!==o?o:1)!==parseInt(null!==(l=null==i?void 0:i.rowSpan)&&void 0!==l?l:1))return void console.log("invalid merge");const s=parseInt(null!==(n=null==a?void 0:a.colSpan)&&void 0!==n?n:1),c=parseInt(null!==(r=null==i?void 0:i.colSpan)&&void 0!==r?r:1);$(t.clientId,{colSpan:s+c}),W(e.innerBlocks.map((e=>e.clientId)),e.clientId,t.clientId),F(e.clientId)},ee=(e,t)=>{var o,l,n,r;const a=N(t.clientId),i=N(e.clientId);if(parseInt(null!==(o=null==a?void 0:a.colSpan)&&void 0!==o?o:1)!==parseInt(null!==(l=null==i?void 0:i.colSpan)&&void 0!==l?l:1))return void console.log("invalid merge");const s=parseInt(null!==(n=null==a?void 0:a.rowSpan)&&void 0!==n?n:1),c=parseInt(null!==(r=null==i?void 0:i.rowSpan)&&void 0!==r?r:1);$(t.clientId,{rowSpan:s+c}),W(e.innerBlocks.map((e=>e.clientId)),e.clientId,t.clientId),F(e.clientId)},te=[{icon:g,title:(0,s.__)("Insert row before","tp"),isDisabled:!e||"tfoot"===(null===(u=null==K?void 0:K.attributes)||void 0===u?void 0:u.type)||"thead"===(null===(v=null==K?void 0:K.attributes)||void 0===v?void 0:v.type),onClick:()=>Q(-1)},{icon:f,title:(0,s.__)("Insert row after","tp"),isDisabled:!e||"tfoot"===(null===(h=null==K?void 0:K.attributes)||void 0===h?void 0:h.type)||"thead"===(null===(w=null==K?void 0:K.attributes)||void 0===w?void 0:w.type),onClick:Q},{icon:_,title:(0,s.__)("Delete row","tp"),isDisabled:!e||"tfoot"===(null===(k=null==K?void 0:K.attributes)||void 0===k?void 0:k.type)||"thead"===(null===(H=null==K?void 0:K.attributes)||void 0===H?void 0:H.type),onClick:()=>{var e;const l=M(t);if(!l)return;if(!K)return;const n=K.innerBlocks[o-1];(null==n?void 0:n.clientId)&&L(n.clientId)&&(F(n.clientId),$(t,{rows:(null===(e=l.attributes)||void 0===e?void 0:e.rows)-1}))}},{icon:y,title:(0,s.__)("Insert column before","tp"),isDisabled:!e,onClick:()=>X(-1)},{icon:x,title:(0,s.__)("Insert column after","tp"),isDisabled:!e,onClick:X},{icon:B,title:(0,s.__)("Delete column","tp"),isDisabled:!e,onClick:()=>{var e;const o=M(t);if(!o)return;const n=[];o.innerBlocks.forEach((e=>{e.name===G&&e.innerBlocks.forEach((e=>{if(e.name!==D)return;const t=e.innerBlocks[l-1];(null==t?void 0:t.clientId)&&L(t.clientId)&&n.push(t.clientId)}))})),U(n),$(t,{columns:(null===(e=o.attributes)||void 0===e?void 0:e.columns)-1})}},{icon:I,title:(0,s.__)("Merge column left","tp"),isDisabled:l<2,onClick:()=>{const e=M(t);e&&e.innerBlocks.some((e=>{var t;if(e.name!==G)return!1;const n=N(e.clientId);return(null==n?void 0:n.type)===(null===(t=null==K?void 0:K.attributes)||void 0===t?void 0:t.type)&&e.innerBlocks.some(((e,t)=>{const n=t+1;if(e.name!==D||n!==o||!e.innerBlocks.length)return!1;let r,a;return e.innerBlocks.some(((e,t)=>{const o=t+1;return o===l-1?r=e:o===l&&(a=e),!(!r||!a)})),!(!a||!r)&&(Z(a,r),!0)}))}))}},{icon:C,title:(0,s.__)("Merge column right","tp"),isDisabled:l===q,onClick:()=>{const e=M(t);e&&(console.log("initiated on",r,d),e.innerBlocks.some((e=>{var t;if(e.name!==G)return!1;const o=N(e.clientId);return(null==o?void 0:o.type)===(null===(t=null==K?void 0:K.attributes)||void 0===t?void 0:t.type)&&e.innerBlocks.some((e=>{if(e.name!==D||!e.innerBlocks.length)return!1;let t,o;return e.innerBlocks.some((e=>{var l,n,a,i,s,c,u,v;const p=null!==(n=null===(l=N(e.clientId))||void 0===l?void 0:l.realRow)&&void 0!==n?n:1,m=null!==(i=null===(a=N(e.clientId))||void 0===a?void 0:a.realColumn)&&void 0!==i?i:1;return p===r&&m===d?(console.log("merge into",p,m),t=e):p===r&&t&&m===(null!==(c=null===(s=N(null==t?void 0:t.clientId))||void 0===s?void 0:s.realColumn)&&void 0!==c?c:1)+(null!==(v=null===(u=N(null==t?void 0:t.clientId))||void 0===u?void 0:u.colSpan)&&void 0!==v?v:1)&&(console.log("merge from",p,m),o=e),!(!t||!o)})),!(!o||!t)&&(Z(o,t),!0)}))})))}},{icon:j,title:(0,s.__)("Merge column up","tp"),isDisabled:o<2||"tfoot"===(null===(E=null==K?void 0:K.attributes)||void 0===E?void 0:E.type)||"thead"===(null===(T=null==K?void 0:K.attributes)||void 0===T?void 0:T.type),onClick:()=>{const e=M(t);if(!e)return;let n,r;e.innerBlocks.some((e=>{var t;if(e.name!==G)return!1;const a=N(e.clientId);return(null==a?void 0:a.type)===(null===(t=null==K?void 0:K.attributes)||void 0===t?void 0:t.type)&&e.innerBlocks.some(((e,t)=>{const a=t+1;return!(e.name!==D||a!==o&&a!==o-1||!e.innerBlocks.length)&&(e.innerBlocks.some(((e,t)=>{const i=t+1;return i===l&&a===o?r=e:i===l&&a===o-1&&(n=e),!(!n||!r)})),!(!r||!n)&&(ee(r,n),!0))}))}))}},{icon:V,title:(0,s.__)("Merge column down","tp"),isDisabled:"tfoot"===(null===(O=null==K?void 0:K.attributes)||void 0===O?void 0:O.type)||"thead"===(null===(P=null==K?void 0:K.attributes)||void 0===P?void 0:P.type),onClick:()=>{const e=M(t);if(!e)return;let o,l;console.log("initiated on",r,d),e.innerBlocks.some((e=>{var t;if(e.name!==G)return!1;const n=N(e.clientId);return(null==n?void 0:n.type)===(null===(t=null==K?void 0:K.attributes)||void 0===t?void 0:t.type)&&e.innerBlocks.some((e=>!(e.name!==D||!e.innerBlocks.length)&&(e.innerBlocks.some((e=>{var t,n,a,i,s,c,u,v;const p=null!==(n=null===(t=N(e.clientId))||void 0===t?void 0:t.realRow)&&void 0!==n?n:1,m=null!==(i=null===(a=N(e.clientId))||void 0===a?void 0:a.realColumn)&&void 0!==i?i:1;return m===d&&p===r?(console.log("merge into",p,m),o=e):o&&m===d&&p===(null!==(c=null===(s=N(null==o?void 0:o.clientId))||void 0===s?void 0:s.realRow)&&void 0!==c?c:1)+(null!==(v=null===(u=N(null==o?void 0:o.clientId))||void 0===u?void 0:u.rowSpan)&&void 0!==v?v:1)&&(console.log("merge from",p,m),l=e),!(!o||!l)})),!(!l||!o)&&(ee(l,o),!0))))}))}}];return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(c.BlockControls,{group:"other",children:(0,i.jsx)(m.ToolbarDropdownMenu,{icon:S,label:(0,s.__)("Edit table","tp"),controls:te})})})}const O=function({className:e,clientId:t,attributes:o,setAttributes:l,isSelected:n,context:r}){const a=(0,c.useBlockProps)({className:w()(e,"travelopia-table__column")}),s=r["travelopia/table-id"],d=r["travelopia/table-row-container-type"],u=r["travelopia/table-row-container-id"],v=(0,c.useInnerBlocksProps)(Object.assign(Object.assign({},a),{colSpan:o.colSpan,rowSpan:o.rowSpan}),{template:[[z]],templateLock:!1}),{row:h,column:k}=(0,b.useSelect)((e=>{const o=e(c.store).getBlockIndex(t),l=e(c.store).getBlockRootClientId(t);return{row:e(c.store).getBlockIndex(l)+1,column:o+1}}),[t]);(0,p.useEffect)((()=>{if(o.isRealCalculated)return;console.log("calculating");const e=(0,b.select)("core/block-editor").getBlockIndex(t),n=(0,b.select)("core/block-editor").getBlockRootClientId(t),r=(0,b.select)("core/block-editor").getBlockIndex(null!=n?n:"");l({realRow:r+1,realColumn:e+1,isRealCalculated:!0})}),[]),(0,p.useEffect)((()=>{l({row:h,column:k})}),[h,k,l]);let g="td";return"tbody"!==d&&(g="th"),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.InspectorControls,{children:(0,i.jsxs)(m.PanelBody,{title:"Attributes",children:[(0,i.jsxs)("p",{children:["Row: ",h]}),(0,i.jsxs)("p",{children:["Column: ",k]}),(0,i.jsxs)("p",{children:["Rowspan: ",o.rowSpan]}),(0,i.jsxs)("p",{children:["Colspan: ",o.colSpan]}),(0,i.jsxs)("p",{children:["Client ID: ",t]}),(0,i.jsxs)("p",{children:["Real Row: ",o.realRow]}),(0,i.jsxs)("p",{children:["Real Column: ",o.realColumn]})]})}),(0,i.jsx)(T,{isSelected:n,tableRow:h,tableColumn:k,tableId:s,rowContainerId:u,realTableRow:o.realRow,realTableColumn:o.realColumn}),(0,i.jsx)(g,Object.assign({},v))]})},R="travelopia/table-column",P={apiVersion:3,icon:v,title:(0,s.__)("Column","tp"),description:(0,s.__)("Individual column of the table.","tp"),parent:["travelopia/table-row"],category:"text",keywords:[(0,s.__)("column","tp")],attributes:{row:{type:"number"},column:{type:"number"},colSpan:{type:"number"},rowSpan:{type:"number"},realRow:{type:"number"},realColumn:{type:"number"},isRealCalculated:{type:"boolean"}},providesContext:{"travelopia/table-row":"row","travelopia/table-column":"column","travelopia/table-row-real":"realRow","travelopia/table-column-real":"realColumn"},usesContext:["travelopia/table-row-container-type","travelopia/table-row-container-id"],supports:{html:!0,color:{text:!0,background:!0}},edit:O,save:()=>(0,i.jsx)(c.InnerBlocks.Content,{})};const M=function(e){const{className:t}=e,o=(0,c.useBlockProps)({className:w()(t,"travelopia-table__row")}),l=(0,c.useInnerBlocksProps)(Object.assign({},o),{allowedBlocks:[R],templateLock:!1});return(0,i.jsx)("tr",Object.assign({},l))},D="travelopia/table-row",A={apiVersion:3,icon:v,title:(0,s.__)("Row","tp"),description:(0,s.__)("Individual row of the table.","tp"),parent:["travelopia/table-row-container"],category:"text",keywords:[(0,s.__)("row","tp")],attributes:{},usesContext:["travelopia/table-row-container-type"],supports:{html:!0,color:{text:!0,background:!0}},edit:M,save:()=>(0,i.jsx)(c.InnerBlocks.Content,{})};const N=function(e){const{className:t,attributes:o,setAttributes:l,clientId:n}=e,r=(0,c.useBlockProps)({className:w()(t,"travelopia-table__row-container")}),a=(0,c.useInnerBlocksProps)(Object.assign({},r),{allowedBlocks:[D]}),d=o.type;return(0,p.useEffect)((()=>{l({blockId:n})}),[n,l]),(0,i.jsxs)(i.Fragment,{children:["thead"===o.type&&(0,i.jsx)(c.InspectorControls,{children:(0,i.jsx)(m.PanelBody,{title:(0,s.__)("Row Container Options","tp"),children:(0,i.jsx)(m.ToggleControl,{label:(0,s.__)("Is Sticky","tp"),checked:o.isSticky,onChange:e=>l({isSticky:e}),help:(0,s.__)("Is this container sticky?","tp")})})}),(0,i.jsx)(d,Object.assign({},a))]})},G="travelopia/table-row-container",L={apiVersion:3,icon:v,title:(0,s.__)("Row Container","tp"),description:(0,s.__)("A container for a row (THEAD, TBODY, TFOOT).","tp"),parent:["travelopia/table"],category:"text",keywords:[(0,s.__)("thead","tp"),(0,s.__)("tbody","tp"),(0,s.__)("tfoot","tp")],attributes:{type:{type:"string",default:"tbody"},isSticky:{type:"boolean",default:!1},blockId:{type:"string"}},providesContext:{"travelopia/table-row-container-type":"type","travelopia/table-row-container-sticky":"isSticky","travelopia/table-row-container-id":"blockId"},supports:{html:!1},edit:N,save:()=>(0,i.jsx)(c.InnerBlocks.Content,{})},F=(e="tbody",t="")=>{const o=(0,b.select)("core/block-editor").getBlock(t);if(!o)return;const l=(0,a.createBlock)(G,{type:e});let n=o.attributes.rows;"tbody"!==e&&(n=1);for(let e=0;e<n;e++){const e=[];for(let t=0;t<o.attributes.columns;t++)e.push((0,a.createBlock)(R,{},[(0,a.createBlock)(z)]));l.innerBlocks.push((0,a.createBlock)(D,{},e))}if("tbody"===e)(0,b.dispatch)("core/block-editor").replaceInnerBlocks(t,[l]);else{const n="thead"===e?0:o.innerBlocks.length;(0,b.dispatch)("core/block-editor").insertBlock(l,n,t)}},U=(e="thead",t="")=>{const o=(0,b.select)("core/block-editor").getBlock(t);o&&o.innerBlocks.length&&o.innerBlocks.forEach((t=>{var o;(null===(o=t.attributes)||void 0===o?void 0:o.type)===e&&(0,b.dispatch)("core/block-editor").removeBlock(t.clientId)}))};const Y=function(e){const{className:t,attributes:o,clientId:l,setAttributes:n}=e,r=(0,c.useBlockProps)({className:w()(t,"travelopia-table")}),a=(0,c.useInnerBlocksProps)({},{allowedBlocks:[G],renderAppender:void 0});return(0,p.useEffect)((()=>{n({blockId:l})}),[l,n]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.InspectorControls,{children:(0,i.jsxs)(m.PanelBody,{title:(0,s.__)("Table Options","tp"),children:[(0,i.jsx)(m.ToggleControl,{label:(0,s.__)("Has THEAD","tp"),checked:o.hasThead,onChange:e=>{e?F("thead",l):U("thead",l),n({hasThead:e})},help:(0,s.__)("Does this table have a header?","tp")}),(0,i.jsx)(m.ToggleControl,{label:(0,s.__)("Has TFOOT","tp"),checked:o.hasTfoot,onChange:e=>{e?F("tfoot",l):U("tfoot",l),n({hasTfoot:e})},help:(0,s.__)("Does this table have a footer?","tp")})]})}),(0,i.jsxs)("figure",Object.assign({},r,{children:[(0===o.rows||0===o.columns)&&(0,i.jsx)(k,Object.assign({},e)),(0!==o.rows||0!==o.columns)&&(0,i.jsx)("table",Object.assign({},a))]}))]})},$="travelopia/table",W={apiVersion:3,icon:v,title:(0,s.__)("TP Table","tp"),description:(0,s.__)("Create structured content in rows and columns to display information.","tp"),category:"text",keywords:[(0,s.__)("table","tp")],attributes:{anchor:{type:"string"},rows:{type:"number",default:0},columns:{type:"number",default:0},blockId:{type:"string"},hasThead:{type:"boolean",default:!1},hasTfoot:{type:"boolean",default:!1}},providesContext:{"travelopia/table-id":"blockId","travelopia/table-total-rows":"rows","travelopia/table-total-columns":"columns","travelopia/table-has-thead":"hasThead","travelopia/table-has-tfoot":"hasTfoot"},supports:{anchor:!0},edit:Y,save:()=>(0,i.jsx)(c.InnerBlocks.Content,{})},q=window.wp.hooks;(0,q.addFilter)("blocks.registerBlockType","travelopia/table-row-column-context",(e=>{const t=["travelopia/table-row","travelopia/table-column","travelopia/table-id","travelopia/table-row-container-id","travelopia/table-row-real","travelopia/table-column-real"];return e.usesContext&&Array.isArray(e.usesContext)&&t.forEach((t=>{var o,l;(null===(o=e.usesContext)||void 0===o?void 0:o.includes(t))||null===(l=e.usesContext)||void 0===l||l.push(t)})),e})),(0,q.addFilter)("editor.BlockEdit","travelopia/table-toolbar",(e=>t=>{const{context:o,isSelected:l}=t;if(!o)return(0,i.jsx)(e,Object.assign({},t));const n=o["travelopia/table-row"],r=o["travelopia/table-column"],a=o["travelopia/table-id"],s=o["travelopia/table-row-container-id"],c=o["travelopia/table-row-real"],d=o["travelopia/table-column-real"];return!n||!r||!a||r<1||n<1||!c||!d||d<1||c<1?(0,i.jsx)(e,Object.assign({},t)):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{isSelected:l,tableRow:n,tableColumn:r,tableId:a,rowContainerId:s,realTableRow:c,realTableColumn:d}),(0,i.jsx)(e,Object.assign({},t))]})}));[r,n,l,t,e].forEach((({name:e,settings:t})=>(0,a.registerBlockType)(e,t)))})()})();
//# sourceMappingURL=blocks.js.map